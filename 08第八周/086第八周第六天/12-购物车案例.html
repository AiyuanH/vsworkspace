<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue 3 Test</title>
    <script src="../vue/vue.js"></script><!-- 确保加载 Vue 3 -->
    <style>
        table {
            border-collapse: collapse;
        }

        th,
        td {
            padding: 15px;
            width: 100px;
            text-align: center;
            border: 1px solid #0af;
        }
    </style>
</head>

<body>
    <div id="app">
        <table>
            <tr>
                <!-- 复选框全选 -->
                <th><input type="checkbox" v-model="isCheckAll" @change="checkedAllFn"></th>
                <!-- 商品名称 -->
                <th>名称</th>
                <!-- 商品价格 -->
                <th>价格</th>
                <!-- 商品数量 -->
                <th>数量</th>
                <!-- 小计 -->
                <th>小计</th>
                <!-- 操作按钮 -->
                <th>操作</th>
            </tr>
            <!--  v-for渲染每个商品项 -->
            <tr v-for="item in goodsArr" :key="item.id">
                <!-- 复选框 -->
                <td><input type="checkbox" v-model="item.isChecked" @change="singleCheckedFn"></td>
                <!-- 商品名称 -->
                <td>{{item.name}}</td>
                <!-- 商品价格 -->
                <td>{{item.price}}</td>
                <!-- 商品数量 -->
                <td>
                    <!--  -  -  +  -  +  -->
                    <button @click="item.count--" :disabled="item.count <= 0">-</button>
                    {{item.count}}
                    <button @click="item.count++">+</button>
                </td>
                <!-- 小计 -->
                <td>{{item.count*item.price}}</td>
                <!-- 删除按钮 -->
                <td><button @click="del(item)">删除</button></td>
            </tr>
            <tr>
                <!-- 总价 -->
                <td>总价：</td>
                <!--  colspan="5"  5  -->
                <td colspan="5">{{totalPrice}}</td>
            </tr>
        </table>
    </div>
    <script>
        const app = Vue.createApp({
            // data  data  data
            data() {
                return {
                    //  1 
                    isCheckedAll: false,
                    //   goodsArr  6 
                    goodsArr: [
                        { id: 1, name: "华为手表",  price: 6, count: 1, isChecked: false },
                        { id: 2, name: "华为手机",  price: 1, count: 1, isChecked: false },
                        { id: 3, name: "华为手环",  price: 2, count: 1, isChecked: false },
                        { id: 4, name: "华为平板",  price: 3, count: 1, isChecked: false },
                        { id: 5, name: "华为笔记本" ,price: 4, count: 1, isChecked: false },
                        { id: 6, name: "华为耳机",  price: 5, count: 1, isChecked: false },
                    ],
                    //  0 
                   
                }
            },
            // methods  methods  methods
            methods: {
                //  del  del  del
                del(item) {
                    //  1 
                    if (item.isChecked) {
                        alert(" 已勾选，不能删除")
                    } else {
                        //  1  1  item   goodsArr
                        this.goodsArr.splice(this.goodsArr.indexOf(item), 1)
                    }
                },
                //  singleCheckedFn  singleCheckedFn  singleCheckedFn
                singleCheckedFn() {
                    //  1  1  1  1  1 
                    this.isSelectedAll = this.goodsArr.every(item => item.isChecked)

                },
                //  checkedAllFn  checkedAllFn  checkedAllFn
                checkedAllFn() {
                    //  1  1  1  1  1 
                    this.goodsArr.forEach(item => {
                        item.isChecked = this.isCheckAll
                    })
                }

            },
            //  computed  computed  computed
            computed: {
                //  totalPrice  totalPrice  totalPrice
                totalPrice() {
                    //  0 
                    let sum = 0;
                    //  1  1  1  1  1 
                    this.goodsArr.forEach(item => {
                        if (item.isChecked) {
                            //  1  1  1  1  1 
                            sum += item.price * item.count
                        }
                    })
                    
                     
                    return sum
                }
            }
        });

        app.mount("#app");
    </script>
</body>

</html>
